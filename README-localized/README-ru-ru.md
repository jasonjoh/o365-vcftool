# Пример импорта и экспорта файлов VCF в Office 365 #

Этот пример Ruby on Rails показывает как использовать [API контакты ](https://msdn.microsoft.com/office/office365/APi/contacts-rest-operations)через [ ruby\_outlook ](http://github.com/jasonjoh/ruby_outlook) gem.

## Необходимое программное обеспечение ##

- [Ruby on Rails](http://rubyonrails.org/)
- [ruby\_outlook](http://github.com/jasonjoh/ruby_outlook)
- [bootstrap-sass](https://rubygems.org/gems/bootstrap-sass)
- [oauth2](https://rubygems.org/gems/oauth2)
- [carrierwave](https://rubygems.org/gems/carrierwave)
- [vcard](https://rubygems.org/gems/vcard)

## Создание идентификатора клиента и секрета ###

Перед тем как продолжить, нужно зарегистрировать наше приложение, чтобы получить идентификатор клиента и секретный код. Перейдите на https://apps.dev.microsoft.com, чтобы быстро получить идентификатор клиента и секрет. Используя кнопки входа, войдите в систему с помощью учетной записи Майкрософт (Outlook.com) или своей рабочей или учебной учетной записи (Office 365).

Войдя в систему, нажмите кнопку **Добавить приложение**. В поле имя введите `VCFTool` и нажмите кнопку **Создать приложение**. После создания приложения найдите раздел **Секреты Приложения** и нажмите кнопку **Создать новый пароль**. Теперь скопируйте пароль и сохраните его в надежном месте. Скопировав пароль, нажмите кнопку **Ok**.

![Диалоговое окно "новый пароль".](./readme-images/app-new-password.PNG)

Найдите раздел **платформ** и нажмите кнопку **добавить платформу**. Выберите **Веб**, а затем введите `http://localhost:8000/authorize` под **Перенаправить URI**. Нажмите **сохранить**, чтобы завершить регистрацию. Скопируйте **Идентификатор Приложения ** и сохраните его вместе с паролем, который вы скопировали ранее. Эти значения скоро понадобятся нам.

Ниже показано, какие сведения необходимо указать при регистрации приложения.

![Заполненные свойства регистрации.](./readme-images/app-registration.PNG)

## Выполнение примера ##

Предполагается, что вы установили Ruby on Rails перед началом.

1. Скачайте или разветвите пример проекта.
1. Откройте командную строку в каталоге, в котором вы скачали проект, и запустите `bundle`, чтобы установить необходимые самоцветы.
1. Выполните `bundle exec rake db:setup` для настройки базы данных.
1. Внесите изменения в файл `.\app\helpers\auth_helper.rb`. Скопируйте идентификатор клиента для своего приложения, полученный во время регистрации приложения, и вставьте его в качестве значения переменной `CLIENT_ID`. Скопируйте ключ, созданный во время регистрации приложения, и вставьте его в качестве значения переменной `CLIENT_SECRET`. Сохраните файл.
1. Запустите сервер, выполнив `rails server` из командной строки.
1. Пройдите в браузере и откройте http://localhost:3000.
1. Чтобы использовать приложение, нажмите кнопку "Войти со своей учетной записью Office 365 или Outlook.com".

## Авторские права ##

(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.

----------
Работайте со мной на сайте Twitter [@JasonJohMSFT](https://twitter.com/JasonJohMSFT)

Следуйте инструкциям в [блоге разработчиков Exchange](http://blogs.msdn.com/b/exchangedev/)